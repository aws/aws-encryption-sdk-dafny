version: 0.2

phases:
  install:
    commands:
      # Get .NET SDK 6.0 (for build tools only; projects specify their own toolchains)
      - Invoke-WebRequest https://dot.net/v1/dotnet-install.ps1 -UseBasicParsing -OutFile dotnet-install.ps1
      - ./dotnet-install.ps1 -Channel 6.0
      # Try preventing intermittent cert issue.
      # See <https://github.com/NuGet/Home/issues/11099> and
      # <https://github.com/NuGet/NuGet.Client/pull/4259#issue-7318389620>
      - set NUGET_EXPERIMENTAL_CHAIN_BUILD_RETRY_POLICY=3,1000
      # Get AWS SDK
      - Install-Module -Name AWS.Tools.Installer
      - Install-AWSToolsModule AWS.Tools.STS,AWS.Tools.S3 -CleanUp
      - Get-Command -Module Microsoft.Powershell.Security
  build:
    commands:
      - cd aws-encryption-sdk-net-formally-verified/Test
